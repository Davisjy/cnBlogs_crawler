<h1>&#x4F7F;&#x7528; Angular CLI &#x548C; Webpack &#x5206;&#x6790;&#x5305;&#x5C3A;&#x5BF8;</h1>
<p>&#x5BF9;&#x4E8E; Web app &#x6765;&#x8BF4;&#xFF0C;&#x9AD8;&#x6027;&#x80FD;&#x603B;&#x662F;&#x6700;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x5BF9;&#x4E8E; Angular &#x4E5F;&#x4E0D;&#x4F8B;&#x5916;&#x3002;&#x4F46;&#x662F;&#x968F;&#x7740;&#x5E94;&#x7528;&#x590D;&#x6742;&#x5EA6;&#x7684;&#x4E0D;&#x65AD;&#x589E;&#x957F;&#xFF0C;&#x6211;&#x4EEC;&#x5982;&#x4F55;&#x624D;&#x80FD;&#x77E5;&#x9053;&#x54EA;&#x4E9B;&#x5185;&#x5BB9;&#x6253;&#x5305;&#x5230;&#x4E86;&#x5E94;&#x7528;&#x4E2D;&#x5462;&#xFF1F;&#x5982;&#x4F55;&#x8DDF;&#x8E2A;&#x5305;&#x7684;&#x5C3A;&#x5BF8;&#xFF1F;&#x6211;&#x4EEC;&#x4E0D;&#x5E0C;&#x671B;&#x4E00;&#x6B21;&#x53D1;&#x9001;&#x592A;&#x591A;&#x7684; JavaScript &#xFF0C;&#x4EE5;&#x81F3;&#x4E8E;&#x62D6;&#x6162;&#x5E94;&#x7528;&#x7684;&#x901F;&#x5EA6;&#x3002;</p>
<p>&#x8FC7;&#x5927;&#x5C3A;&#x5BF8;&#x7684; JavaScript &#x5305;&#x662F;&#x4E27;&#x5931;&#x7528;&#x6237;&#x6B22;&#x5FC3;&#x7684;&#x826F;&#x836F;&#x3002;&#x4E0D;&#x4EC5;&#x662F;&#x62D6;&#x6162;&#x4E86;&#x4E0B;&#x8F7D;&#x6548;&#x7387;&#xFF0C;&#x800C;&#x4E14;&#x8981;&#x82B1;&#x8D39;&#x66F4;&#x591A;&#x7684;&#x65F6;&#x95F4;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x4E2D;&#x5206;&#x6790;&#x7136;&#x540E;&#x6267;&#x884C;&#x3002;&#x4E3A;&#x4E86;&#x4FDD;&#x6301;&#x5E94;&#x7528;&#x7684;&#x901F;&#x5EA6;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x5305;&#x5C3A;&#x5BF8;&#x8DB3;&#x591F;&#x5C0F;&#xFF08;250k &#x6216;&#x66F4;&#x5C0F;&#xFF09;&#xFF0C;&#x5E76;&#x5728;&#x9002;&#x5F53;&#x7684;&#x65F6;&#x95F4;&#x52A0;&#x8F7D;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528; <a href="https://cli.angular.io/" target="_blank">Angular CLI</a> &#x548C;&#x4E00;&#x4E9B;&#x7B80;&#x5355;&#x7684;&#xFFFD;&#xFFFD;&#x4EE4;&#x6765;&#x83B7;&#x5F97;&#x6211;&#x4EEC;&#x53D1;&#x5E03;&#x4EA7;&#x54C1;&#x7684; Angular &#x5E94;&#x7528;&#x5305;&#x7684;&#x8BE6;&#x7EC6;&#x62A5;&#x544A;&#x3002;</p>
<h2><span style="font-size: 1.17em;">Angular CLI</span></h2>
<p>1. &#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x6709;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x4F5C;&#x4E3A;&#x5206;&#x6790;&#x5BF9;&#x8C61;&#x3002;&#x4F7F;&#x7528; Angular CLI &#x7684; new &#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x5F88;&#x7B80;&#x5355;&#x5730;&#x521B;&#x5EFA;&#x4E00;&#x4E2A; Angular &#x5E94;&#x7528;&#x3002;</p>
<p><code>ng new [&#x5E94;&#x7528;&#x540D;&#x79F0;]</code>&#xA0;</p>
<p>&#x5E94;&#x7528;&#x5C06;&#x88AB;&#x521B;&#x5EFA;&#x5728;&#x5E94;&#x7528;&#x540D;&#x79F0;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#x3002;</p>
<p><em><a href="https://github.com/angular/angular-cli/wiki/new" target="_blank">&#x67E5;&#x770B; new &#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;</a></em></p>
<p>&#xA0;</p>
<p>2. &#x7136;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4EA7;&#x54C1;&#x6A21;&#x5F0F;&#x7F16;&#x8BD1;&#x5E94;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528; CLI &#x7684;&#x547D;&#x4EE4;&#x8FDB;&#x884C;&#x7F16;&#x8BD1;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x6D89;&#x53CA;&#x5230;&#x4E24;&#x4E2A;&#x4E3B;&#x8981;&#x53C2;&#x6570; prod &#x548C; stats-json</p>
<h4>2.1 prod</h4>
<p>&#x4EA7;&#x54C1;&#x6A21;&#x5F0F;&#x7F16;&#x8BD1;&#x4F7F;&#x7528;&#x53C2;&#x6570; prod&#xFF0C;&#x4E0B;&#x9762;&#x662F; dev &#x548C; prod &#x7684;&#x533A;&#x522B;</p>
<p>&#x4F7F;&#x7528;&#xA0;<code>--dev</code>/<code>--target=development</code>&#xA0;&#x548C;&#xA0;<code>--prod</code>/<code>--target=production</code>&#xA0;&#x4E24;&#x8005;&#x90FD;&#x5F71;&#x54CD;&#x5143;&#x6807;&#x5FD7;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;&#xA0;<code>--dev</code>&#xA0;.</p>
<table style="height: 145px; width: 892px;">
<thead>
<tr><th>Flag</th><th><code>--dev</code></th><th><code>--prod</code></th></tr>
</thead>
<tbody>
<tr>
<td><code>--aot</code></td>
<td><code>false</code></td>
<td><code>true</code></td>
</tr>
<tr>
<td><code>--environment</code></td>
<td><code>dev</code></td>
<td><code>prod</code></td>
</tr>
<tr>
<td><code>--output-hashing</code></td>
<td><code>media</code></td>
<td><code>all</code></td>
</tr>
<tr>
<td><code>--sourcemaps</code></td>
<td><code>true</code></td>
<td><code>false</code></td>
</tr>
<tr>
<td><code>--extract-css</code></td>
<td><code>false</code></td>
<td><code>true</code></td>
</tr>
<tr>
<td><code>--named-chunks</code>&#xA0;&#xA0;</td>
<td><code>true</code></td>
<td><code>false</code></td>
</tr>
<tr>
<td><code>--build-optimizer</code></td>
<td><code>false</code></td>
<td><code>true</code>&#xA0;with AOT and Angular 5</td>
</tr>
</tbody>
</table>
<p><code>--prod</code>&#xA0;&#x8FD8;&#x8BBE;&#x7F6E;&#x4E86;&#x4E0B;&#x5217;&#x7684;&#x8BBE;&#x7F6E;:</p>
<ul>
<li>&#x5982;&#x679C;&#x5728;&#xA0;<code>.angular-cli.json &#x4E2D;&#x8FDB;&#x884C;&#x4E86;&#x914D;&#x7F6E;&#xFF0C;</code>&#x6DFB;&#x52A0; service worker.</li>
<li>&#x5728;&#x6A21;&#x5757;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528; production &#x66FF;&#x6362;&#xA0;<code>process.env.NODE_ENV</code>&#xA0;&#x7684;&#x503C;&#x3002;</li>
<li>&#x5BF9;&#x4EE3;&#x7801;&#x6267;&#x884C; UglifyJS .</li>
</ul>
<p>&#xA0;</p>
<h4>2.2&#xA0;&#xA0;<code>--stats-json</code></h4>
<p>&#x8BE5;&#x53C2;&#x6570;&#x7528;&#x4E8E;&#x751F;&#x6210;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#xA0;&#xA0;<code><a href="https://github.com/webpack-contrib/webpack-bundle-analyzer" target="_blank">webpack-bundle-analyzer</a>&#xA0;</code>&#x6216;&#x8005; <a href="https://webpack.github.io/analyse" target="_blank">https://webpack.github.io/analyse</a>&#xA0; &#x5206;&#x6790;&#x5305;&#x7ED3;&#x6784;&#x7684; stats.json &#x6587;&#x4EF6;&#x3002;</p>
<h4>2.3 &#x5B9E;&#x9645;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#xA0;</h4>
<div class="cnblogs_code">
<pre>ng build --prod --stats-json</pre>
</div>
<p>&#xA0;</p>
<p><em><a href="https://github.com/angular/angular-cli/wiki/build" target="_blank">&#x67E5;&#x770B; build &#x7684;&#xFFFD;&#xFFFD;&#x7EC6;&#x4FE1;&#x606F;</a></em></p>
<h2>Webpack bundle analyzer</h2>
<p>States.json &#x662F; <a href="https://webpack.js.org/" target="_blank">Webpack</a>&#xA0;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x6587;&#x4EF6;&#xFF0C;webpack &#x662F; Angular CLI &#x5185;&#x90E8;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x6253;&#x5305;&#x5DE5;&#x5177;&#x3002;&#x4F7F;&#x7528; Webpack &#x5E2E;&#x6211;&#x4EEC;&#x751F;&#x6210;&#x7684;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5404;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x5DE5;&#x5177;&#x6765;&#x7406;&#x89E3;&#x6211;&#x4EEC;&#x7684;&#x5E94;&#x7528;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x7684;&#x5DE5;&#x5177;&#x662F;&#xA0;&#xA0;<a href="https://github.com/th0r/webpack-bundle-analyzer">Webpack bundle analyzer</a>&#xA0;&#x3002;webpack &#x5305;&#x5206;&#x6790;&#x5668;&#x662F;&#x4E00;&#x4E2A; npm &#x5305;&#xFF0C;&#x53EF;&#x4EE5;&#x5728; webpack &#x7684;&#x914D;&#x7F6E;&#x4E2D;&#x6216;&#x8005;&#x547D;&#x4EE4;&#x884C;&#x4F7F;&#x7528;&#x3002;&#x5BF9;&#x4E8E;&#x6211;&#x4EEC;&#x6765;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x884C;&#x5DE5;&#x5177;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5982;&#x4E0B;&#x6B65;&#x9AA4;&#xFF1A;</p>
<ol>
<li>&#x901A;&#x8FC7; npm &#x5B89;&#x88C5;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#xA0;
<div class="cnblogs_code">
<pre>npm <span style="color: #0000ff;">install</span> --save-dev webpack-bundle-analyzer</pre>
</div>
</li>
<li>&#x4E3A;&#x65B9;&#x4FBF;&#x4F7F;&#x7528;&#xFF0C;&#x5B89;&#x88C5;&#x4E4B;&#x540E;&#xFF0C;&#x5728; package.json &#x4E2D;&#x7684; scripts &#x90E8;&#x5206;&#xFF0C;&#x6DFB;&#x52A0;&#x4E0B;&#x9762;&#x7684;&#x884C;&#x6765;&#x521B;&#x5EFA;&#x81EA;&#x5B9A;&#x4E49;&#x7684; npm &#x547D;&#x4EE4;&#xA0;
<div class="cnblogs_code">
<pre><span style="color: #800000;">&quot;</span><span style="color: #800000;">bundle-report</span><span style="color: #800000;">&quot;</span>: <span style="color: #800000;">&quot;</span><span style="color: #800000;">webpack-bundle-analyzer dist/stats.json</span><span style="color: #800000;">&quot;</span></pre>
</div>
</li>
<li>&#x6267;&#x884C;&#x547D;&#x4EE4;&#xA0;
<div class="cnblogs_code">
<pre>npm run bundle-report</pre>
</div>
<p>&#xA0;</p>
</li>
</ol>
<p>&#x5982;&#x679C;&#x547D;&#x4EE4;&#x6210;&#x529F;&#x6267;&#x884C;&#x7684;&#x8BDD;&#xFF0C;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x6253;&#x5F00;&#x4E86;&#x4E00;&#x4E2A;&#x6D4F;&#x89C8;&#x5668;&#x7A97;&#x53E3;&#xFF0C;&#x5E76;&#x770B;&#x5230;&#x7C7B;&#x4F3C;&#x5982;&#x4E0B;&#x7684;&#x9875;&#x9762;&#x3002;</p>
<p><img src="https://images2018.cnblogs.com/blog/13475/201804/13475-20180410105615932-194086955.png" alt=""></p>
<p>&#x9014;&#x4E2D;&#x7684;&#x6BCF;&#x79CD;&#x989C;&#x8272;&#x4EE3;&#x8868;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x5305;&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x56FE;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6211;&#x4EEC;&#x6709;&#x4E09;&#x4E2A;&#x5305;&#xFF0C;vendor &#x4E2D;&#x5305;&#x542B;&#x6240;&#x6709;&#x7684;&#x5E93;&#x4EE3;&#x7801;&#xFF0C;polyfill &#x5305;&#x548C; main &#x5E94;&#x7528;&#x4EE3;&#x7801;&#x5305;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8FD1;&#x4E00;&#x534A;&#x67E5;&#x770B;&#x672A;&#x538B;&#x7F29;&#x548C;&#x538B;&#x7F29;&#x4E4B;&#x540E;&#x7684;&#x5C3A;&#x5BF8;&#x3002;&#x8FD9;&#x4F7F;&#x5F97;&#x6211;&#x4EEC;&#x5FEB;&#x901F;&#x68C0;&#x67E5;&#x6700;&#x5927;&#x7684;&#x5305;&#xFF0C;&#x5E76;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x51B3;&#x5B9A;&#x4F55;&#x65F6;&#x4F7F;&#x7528;&#xA0;<a href="https://angular.io/docs/ts/latest/guide/ngmodule.html#!#lazy-load">Lazy Loading</a>&#xA0;&#x8FDB;&#x4E00;&#x6B65;&#x62C6;&#x5206;&#x5E94;&#x7528;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x8FD9;&#x4E2A;&#x793A;&#x4F8B;&#x6765;&#x8BF4;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5E94;&#x7528;&#x7684;&#x4E3B;&#x8981;&#x90E8;&#x5206;&#x662F; framework &#x90E8;&#x5206;&#xFF0C;&#x56E0;&#x4E3A;&#x5E94;&#x7528;&#x592A;&#x7B80;&#x5355;&#x4E86;&#xFF0C;&#x5728; main &#x4E2D;&#x53EA;&#x6709;&#x5F88;&#x5C11;&#x7684;&#x7EC4;&#x4EF6;&#x3002;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x867D;&#x7136; Http &#x6A21;&#x5757;&#x6CA1;&#x6709;&#x88AB;&#x4F7F;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x4E5F;&#x88AB;&#x6253;&#x5305;&#x5230;&#x5E94;&#x7528;&#x4E2D;&#x4E86;&#x3002;&#x5728;&#x79FB;&#x9664;&#x8FD9;&#x4E2A;&#x672A;&#x7528;&#x5230;&#x7684;&#x6A21;&#x5757;&#x4E4B;&#x540E;&#xFF0C;&#x5E94;&#x7528;&#x6BD4;&#x4EE5;&#x524D;&#x53D8;&#x5F97;&#x66F4;&#x5C0F;&#x66F4;&#x5FEB;&#x4E86;&#x3002;</p>
<p>&#x968F;&#x7740;&#x5E94;&#x7528;&#x7684;&#x6210;&#x957F;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD0;&#x884C; npm run bundle-report &#x6765;&#x4ED4;&#x7EC6;&#x5206;&#x6790;&#x548C;&#x68C0;&#x67E5;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#xFF0C;&#x4EE5;&#x4FDD;&#x6301;&#x5E94;&#x7528;&#x7684;&#x5C3A;&#x5BF8;&#x548C;&#x901F;&#x5EA6;&#x3002;</p>
<h2>See also</h2>
<ul>
<li>
<p class="post-title"><a href="https://coryrylan.com/blog/analyzing-bundle-size-with-the-angular-cli-and-webpack" target="_blank">Analyzing bundle size with the Angular CLI and Webpack</a></p>
</li>
<li><a href="https://github.com/webpack-contrib/webpack-bundle-analyzer" target="_blank">Webpack bundle analyzer</a></li>
<li><a href="https://webpack.github.io/analyse" target="_blank">https://webpack.github.io/analyse</a></li>
<li><a href="https://github.com/angular/angular-cli/wiki/build" target="_blank">Angular CLI build</a></li>
</ul>